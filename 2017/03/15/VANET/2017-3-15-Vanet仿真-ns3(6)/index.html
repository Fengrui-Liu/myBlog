<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">


    <link rel="dns-prefetch" href="https://cdn1.lncld.net">




    <link rel="dns-prefetch" href="https://cdn1.lncld.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">



    <link rel="dns-prefetch" href="https://hm.baidu.com">



    <link rel="dns-prefetch" href="https://fonts.googleapis.com">





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            VANET仿真-ns3(6) | 
        
        Fengrui Liu&#39;s Blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content>
    <meta name="keywords" content=",VANET,ns3">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?NKhlKQkXw/c66TR5p4wO+w==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/github-v2.min.css?AfzKxt++K+/lhZBlSjnxwg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Fengrui Liu&#39;s Blog">
    <meta name="msapplication-starturl" content="http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Fengrui Liu&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="VANET仿真-ns3(6) | Fengrui Liu&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content>
    <meta property="og:article:tag" content="VANET"> <meta property="og:article:tag" content="ns3"> 

    
        <meta property="article:published_time" content="Wed Mar 15 2017 00:00:00 GMT+0800">
        <meta property="article:modified_time" content="Fri Mar 30 2018 16:14:17 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/index.html",
    "headline": "VANET仿真-ns3(6)",
    "datePublished": "Wed Mar 15 2017 00:00:00 GMT+0800",
    "dateModified": "Fri Mar 30 2018 16:14:17 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Fengrui Liu",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "Hi, nice to meet you!"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Fengrui Liu&#39;s Blog",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",VANET,ns3",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?cb311870647e05b5531669744dec3faf';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn" class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#VANET-仿真"><span class="post-toc-text">VANET 仿真</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                VANET仿真-ns3(6)
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar">
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Fengrui Liu</strong>
        <span>3月 15, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/VANET/">VANET</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/ns3/">ns3</a>
    </li></ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=VANET仿真-ns3(6)&url=http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/index.html&pic=http://www.liufr.com/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=VANET仿真-ns3(6)&url=http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/index.html&via=Fengrui Liu" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Fengrui Liu&#39;s Blog&title=VANET仿真-ns3(6)&summary=&pics=http://www.liufr.com/img/favicon.png&url=http://www.liufr.com/2017/03/15/VANET/2017-3-15-Vanet仿真-ns3(6)/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="VANET-仿真"><a href="#VANET-仿真" class="headerlink" title="VANET 仿真"></a>VANET 仿真</h2><p>ns3/examples/routing/manet-routing-compare.cc</p>
<p>该代码是在ns-3上运行DSDV，AODV，OLSR，仿真场景是典型的随机运动模型。<br>默认情况下，模拟共200s，前50s是启动时间；共50个节点，节点遵从RandomWaypointMobilityModel模型，运动速度20m/s，无暂停，运动范围300*1500 m的区域范围之内。WiFi的传播速度为2Mb/s，遵守Friis loss model(认为是ns-3中的一个模型)，广播发射功率为7.5dBm。</p>
<p>在这里，运动与密度模型、可以通过速度和节点数量被直接修改，也可以改变发射功率（很显然，当发射功率增加时，运动所造成的影响就减少了，密度造成的影响相应增大）。</p>
<p>默认是OLSR路由协议，参数2是AODV，3是DSDV。</p>
<p>默认状态下，有10对源数据对发送UDP，速度为2.048 kbps。均在50~51s内开始发送。</p>
<p>标准输出</p>
<ol>
<li>包接收：<timestamp> <node-id> received one packet from <src-address></src-address></node-id></timestamp></li>
<li>每秒数据接收都会制表并输出成csv文件</li>
<li>一些追踪和流监视器会在程序运行时输出一些状态信息</li>
</ol>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/core-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/network-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/internet-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/mobility-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/wifi-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/aodv-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/olsr-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/dsdv-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/dsr-module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ns3/applications-module.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> ns3;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> dsr;</span><br><span class="line"></span><br><span class="line">NS_LOG_COMPONENT_DEFINE (<span class="string">"manet-routing-compare"</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RoutingExperiment</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  RoutingExperiment ();</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Run</span> <span class="params">(<span class="keyword">int</span> nSinks, <span class="keyword">double</span> txp, <span class="built_in">std</span>::<span class="built_in">string</span> CSVfileName)</span></span>;</span><br><span class="line">  <span class="comment">//static void SetMACParam (ns3::NetDeviceContainer &amp; devices,</span></span><br><span class="line">  <span class="comment">//                                 int slotDistance);</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">CommandSetup</span> <span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> \**argv)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  Ptr&lt;Socket&gt; SetupPacketReceive (Ipv4Address addr, Ptr&lt;Node&gt; node);</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">ReceivePacket</span> <span class="params">(Ptr&lt;Socket&gt; socket)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">CheckThroughput</span> <span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">uint32_t</span> port;</span><br><span class="line">  <span class="keyword">uint32_t</span> bytesTotal;</span><br><span class="line">  <span class="keyword">uint32_t</span> packetsReceived;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> m_CSVfileName;</span><br><span class="line">  <span class="keyword">int</span> m_nSinks;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> m_protocolName;</span><br><span class="line">  <span class="keyword">double</span> m_txp;</span><br><span class="line">  <span class="keyword">bool</span> m_traceMobility;</span><br><span class="line">  <span class="keyword">uint32_t</span> m_protocol;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置端口号、字节数、接收包的个数、CSV文件名、移动追踪、协议等</span></span><br><span class="line">RoutingExperiment::RoutingExperiment ()</span><br><span class="line">  : port (<span class="number">9</span>),</span><br><span class="line">    bytesTotal (<span class="number">0</span>),</span><br><span class="line">    packetsReceived (<span class="number">0</span>),</span><br><span class="line">    m_CSVfileName (<span class="string">"manet-routing.output.csv"</span>),</span><br><span class="line">    m_traceMobility (<span class="literal">false</span>),</span><br><span class="line">    m_protocol (<span class="number">2</span>) <span class="comment">// AODV</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在RoutingExperiment::ReceivePacket中使用</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="built_in">std</span>::<span class="built_in">string</span></span><br><span class="line">PrintReceivedPacket (Ptr&lt;Socket&gt; socket, Ptr&lt;Packet&gt; packet, Address senderAddress)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//自动分配缓冲区，格式化字符串</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">ostringstream</span> oss;</span><br><span class="line"></span><br><span class="line">  oss &lt;&lt; Simulator::Now ().GetSeconds () &lt;&lt; <span class="string">" "</span> &lt;&lt; socket-&gt;GetNode ()-&gt;GetId ();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果找到匹配的地址，那么就把地址也表示出来</span></span><br><span class="line">  <span class="keyword">if</span> (InetSocketAddress::IsMatchingType (senderAddress))</span><br><span class="line">    &#123;</span><br><span class="line">      InetSocketAddress addr = InetSocketAddress::ConvertFrom (senderAddress);</span><br><span class="line">      oss &lt;&lt; <span class="string">" received one packet from "</span> &lt;&lt; addr.GetIpv4 ();</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      oss &lt;&lt; <span class="string">" received one packet!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">return</span> oss.str ();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">RoutingExperiment::ReceivePacket (Ptr&lt;Socket&gt; socket)</span><br><span class="line">&#123;</span><br><span class="line">  Ptr&lt;Packet&gt; packet;</span><br><span class="line">  Address senderAddress;</span><br><span class="line">  <span class="comment">//从socket中读取一个数据包packet，并且检索发送地址，保存到变量senderAddress中</span></span><br><span class="line">  <span class="keyword">while</span> ((packet = socket-&gt;RecvFrom (senderAddress)))</span><br><span class="line">    &#123;</span><br><span class="line">      bytesTotal += packet-&gt;GetSize ();</span><br><span class="line">      packetsReceived += <span class="number">1</span>;</span><br><span class="line">      NS_LOG_UNCOND (PrintReceivedPacket (socket, packet, senderAddress));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">RoutingExperiment::CheckThroughput ()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//先计算kbs，然后再把bytesTotal清零，用于计算下一次的kbs</span></span><br><span class="line">  <span class="keyword">double</span> kbs = (bytesTotal * <span class="number">8.0</span>) / <span class="number">1000</span>;</span><br><span class="line">  bytesTotal = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//写操作到csv文件中</span></span><br><span class="line">  std::ofstream out (m_CSVfileName.c_str (), std::ios::app);</span><br><span class="line"></span><br><span class="line">  out &lt;&lt; (Simulator::Now ()).GetSeconds () &lt;&lt; <span class="string">","</span></span><br><span class="line">      &lt;&lt; kbs &lt;&lt; <span class="string">","</span></span><br><span class="line">      &lt;&lt; packetsReceived &lt;&lt; <span class="string">","</span></span><br><span class="line">      &lt;&lt; m_nSinks &lt;&lt; <span class="string">","</span></span><br><span class="line">      &lt;&lt; m_protocolName &lt;&lt; <span class="string">","</span></span><br><span class="line">      &lt;&lt; m_txp &lt;&lt; <span class="string">""</span></span><br><span class="line">      &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  out.close ();</span><br><span class="line">  <span class="comment">//同理，这里packetsReceived也需要清零</span></span><br><span class="line">  packetsReceived = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//设置1s延时之后执行CheckThroughput，this标明是谁唤醒成员函数</span></span><br><span class="line">  Simulator::Schedule (Seconds (<span class="number">1.0</span>), &amp;RoutingExperiment::CheckThroughput, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Ptr&lt;Socket&gt;</span><br><span class="line">RoutingExperiment::SetupPacketReceive (Ipv4Address addr, Ptr&lt;Node&gt; node)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//通过名字返回一个TypeId</span></span><br><span class="line">  TypeId tid = TypeId::LookupByName (<span class="string">"ns3::UdpSocketFactory"</span>);</span><br><span class="line">  Ptr&lt;Socket&gt; sink = Socket::CreateSocket (node, tid);</span><br><span class="line">  InetSocketAddress local = InetSocketAddress (addr, port);</span><br><span class="line">  sink-&gt;Bind (local);</span><br><span class="line">  <span class="comment">//设置回调</span></span><br><span class="line">  sink-&gt;SetRecvCallback (MakeCallback (&amp;RoutingExperiment::ReceivePacket, <span class="keyword">this</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> sink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span></span><br><span class="line">RoutingExperiment::CommandSetup (<span class="keyword">int</span> argc, <span class="keyword">char</span> \**argv)</span><br><span class="line">&#123;</span><br><span class="line">  CommandLine cmd;</span><br><span class="line">  cmd.AddValue (<span class="string">"CSVfileName"</span>, <span class="string">"The name of the CSV output file name"</span>, m_CSVfileName);</span><br><span class="line">  cmd.AddValue (<span class="string">"traceMobility"</span>, <span class="string">"Enable mobility tracing"</span>, m_traceMobility);</span><br><span class="line">  cmd.AddValue (<span class="string">"protocol"</span>, <span class="string">"1=OLSR;2=AODV;3=DSDV;4=DSR"</span>, m_protocol);</span><br><span class="line">  cmd.Parse (argc, argv);</span><br><span class="line">  <span class="keyword">return</span> m_CSVfileName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">main (<span class="keyword">int</span> argc, <span class="keyword">char</span> \*argv[])</span><br><span class="line">&#123;</span><br><span class="line">  RoutingExperiment experiment;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> CSVfileName = experiment.CommandSetup (argc,argv);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//blank out the last output file and write the column headers</span></span><br><span class="line">  std::ofstream out (CSVfileName.c_str ());</span><br><span class="line">  out &lt;&lt; <span class="string">"SimulationSecond,"</span> &lt;&lt;</span><br><span class="line">  <span class="string">"ReceiveRate,"</span> &lt;&lt;</span><br><span class="line">  <span class="string">"PacketsReceived,"</span> &lt;&lt;</span><br><span class="line">  <span class="string">"NumberOfSinks,"</span> &lt;&lt;</span><br><span class="line">  <span class="string">"RoutingProtocol,"</span> &lt;&lt;</span><br><span class="line">  <span class="string">"TransmissionPower"</span> &lt;&lt;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">  out.close ();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> nSinks = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">double</span> txp = <span class="number">7.5</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//节点数10，传播功率7.5</span></span><br><span class="line">  experiment.Run (nSinks, txp, CSVfileName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">RoutingExperiment::Run (<span class="keyword">int</span> nSinks, <span class="keyword">double</span> txp, <span class="built_in">std</span>::<span class="built_in">string</span> CSVfileName)</span><br><span class="line">&#123;</span><br><span class="line">  Packet::EnablePrinting ();</span><br><span class="line">  m_nSinks = nSinks;</span><br><span class="line">  m_txp = txp;</span><br><span class="line">  m_CSVfileName = CSVfileName;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> nWifis = <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">double</span> TotalTime = <span class="number">200.0</span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">rate</span> <span class="params">(<span class="string">"2048bps"</span>)</span></span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">phyMode</span> <span class="params">(<span class="string">"DsssRate11Mbps"</span>)</span></span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="function"><span class="built_in">string</span> <span class="title">tr_name</span> <span class="params">(<span class="string">"manet-routing-compare"</span>)</span></span>;</span><br><span class="line">  <span class="keyword">int</span> nodeSpeed = <span class="number">20</span>; <span class="comment">//in m/s</span></span><br><span class="line">  <span class="keyword">int</span> nodePause = <span class="number">0</span>; <span class="comment">//in s</span></span><br><span class="line">  m_protocolName = <span class="string">"protocol"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//这里OnOffApplication生成了一个单向的交通流，有以下两个属性可以设置</span></span><br><span class="line">  Config::SetDefault  (<span class="string">"ns3::OnOffApplication::PacketSize"</span>,StringValue (<span class="string">"64"</span>));</span><br><span class="line">  Config::SetDefault (<span class="string">"ns3::OnOffApplication::DataRate"</span>,  StringValue (rate));</span><br><span class="line"></span><br><span class="line">  <span class="comment">//将非单播模式设置成单播</span></span><br><span class="line">  Config::SetDefault (<span class="string">"ns3::WifiRemoteStationManager::NonUnicastMode"</span>,StringValue (phyMode));</span><br><span class="line"></span><br><span class="line">  NodeContainer adhocNodes;</span><br><span class="line">  adhocNodes.Create (nWifis);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// setting up wifi phy and channel using helpers</span></span><br><span class="line">  WifiHelper wifi;</span><br><span class="line">  wifi.SetStandard (WIFI_PHY_STANDARD_80211b);</span><br><span class="line"></span><br><span class="line">  YansWifiPhyHelper wifiPhy =  YansWifiPhyHelper::Default ();</span><br><span class="line">  YansWifiChannelHelper wifiChannel;</span><br><span class="line">  wifiChannel.SetPropagationDelay (<span class="string">"ns3::ConstantSpeedPropagationDelayModel"</span>);</span><br><span class="line">  wifiChannel.AddPropagationLoss (<span class="string">"ns3::FriisPropagationLossModel"</span>);</span><br><span class="line">  wifiPhy.SetChannel (wifiChannel.Create ());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Add a mac and disable rate control</span></span><br><span class="line">  WifiMacHelper wifiMac;</span><br><span class="line">  wifi.SetRemoteStationManager (<span class="string">"ns3::ConstantRateWifiManager"</span>,</span><br><span class="line">                                <span class="string">"DataMode"</span>,StringValue (phyMode),</span><br><span class="line">                                <span class="string">"ControlMode"</span>,StringValue (phyMode));</span><br><span class="line"></span><br><span class="line">  wifiPhy.Set (<span class="string">"TxPowerStart"</span>,DoubleValue (txp));</span><br><span class="line">  wifiPhy.Set (<span class="string">"TxPowerEnd"</span>, DoubleValue (txp));</span><br><span class="line"></span><br><span class="line">  wifiMac.SetType (<span class="string">"ns3::AdhocWifiMac"</span>);</span><br><span class="line">  NetDeviceContainer adhocDevices = wifi.Install (wifiPhy, wifiMac, adhocNodes);</span><br><span class="line"></span><br><span class="line">  MobilityHelper mobilityAdhoc;</span><br><span class="line">  <span class="comment">//为了能持续性地得到移动交叉场景</span></span><br><span class="line">  <span class="keyword">int64_t</span> streamIndex = <span class="number">0</span>; <span class="comment">// used to get consistent mobility across scenarios</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//设置运动范围</span></span><br><span class="line">  ObjectFactory pos;</span><br><span class="line">  pos.SetTypeId (<span class="string">"ns3::RandomRectanglePositionAllocator"</span>);</span><br><span class="line">  pos.Set (<span class="string">"X"</span>, StringValue (<span class="string">"ns3::UniformRandomVariable[Min=0.0|Max=300.0]"</span>));</span><br><span class="line">  pos.Set (<span class="string">"Y"</span>, StringValue (<span class="string">"ns3::UniformRandomVariable[Min=0.0|Max=1500.0]"</span>));</span><br><span class="line"></span><br><span class="line">  Ptr&lt;PositionAllocator&gt; taPositionAlloc = pos.Create ()-&gt;GetObject&lt;PositionAllocator&gt; ();</span><br><span class="line">  streamIndex += taPositionAlloc-&gt;AssignStreams (streamIndex);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">stringstream</span> ssSpeed;</span><br><span class="line">  ssSpeed &lt;&lt; <span class="string">"ns3::UniformRandomVariable[Min=0.0|Max="</span> &lt;&lt; nodeSpeed &lt;&lt; <span class="string">"]"</span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">stringstream</span> ssPause;</span><br><span class="line">  ssPause &lt;&lt; <span class="string">"ns3::ConstantRandomVariable[Constant="</span> &lt;&lt; nodePause &lt;&lt; <span class="string">"]"</span>;</span><br><span class="line">  mobilityAdhoc.SetMobilityModel (<span class="string">"ns3::RandomWaypointMobilityModel"</span>,</span><br><span class="line">                                  <span class="string">"Speed"</span>, StringValue (ssSpeed.str ()),</span><br><span class="line">                                  <span class="string">"Pause"</span>, StringValue (ssPause.str ()),</span><br><span class="line">                                  <span class="string">"PositionAllocator"</span>, PointerValue (taPositionAlloc));</span><br><span class="line">  mobilityAdhoc.SetPositionAllocator (taPositionAlloc);</span><br><span class="line">  mobilityAdhoc.Install (adhocNodes);</span><br><span class="line">  streamIndex += mobilityAdhoc.AssignStreams (adhocNodes, streamIndex);</span><br><span class="line"></span><br><span class="line">  AodvHelper aodv;</span><br><span class="line">  OlsrHelper olsr;</span><br><span class="line">  DsdvHelper dsdv;</span><br><span class="line">  DsrHelper dsr;</span><br><span class="line">  DsrMainHelper dsrMain;</span><br><span class="line">  Ipv4ListRoutingHelper <span class="built_in">list</span>;</span><br><span class="line">  InternetStackHelper internet;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (m_protocol)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="built_in">list</span>.Add (olsr, <span class="number">100</span>);</span><br><span class="line">      m_protocolName = <span class="string">"OLSR"</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      <span class="built_in">list</span>.Add (aodv, <span class="number">100</span>);</span><br><span class="line">      m_protocolName = <span class="string">"AODV"</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      <span class="built_in">list</span>.Add (dsdv, <span class="number">100</span>);</span><br><span class="line">      m_protocolName = <span class="string">"DSDV"</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">      m_protocolName = <span class="string">"DSR"</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      NS_FATAL_ERROR (<span class="string">"No such protocol:"</span> &lt;&lt; m_protocol);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (m_protocol &lt; <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      internet.SetRoutingHelper (<span class="built_in">list</span>);</span><br><span class="line">      internet.Install (adhocNodes);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (m_protocol == <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      internet.Install (adhocNodes);</span><br><span class="line">      dsrMain.Install (dsr, adhocNodes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  NS_LOG_INFO (<span class="string">"assigning ip address"</span>);</span><br><span class="line"></span><br><span class="line">  Ipv4AddressHelper addressAdhoc;</span><br><span class="line">  addressAdhoc.SetBase (<span class="string">"10.1.1.0"</span>, <span class="string">"255.255.255.0"</span>);</span><br><span class="line">  Ipv4InterfaceContainer adhocInterfaces;</span><br><span class="line">  adhocInterfaces = addressAdhoc.Assign (adhocDevices);</span><br><span class="line"></span><br><span class="line">  OnOffHelper onoff1 ("ns3::UdpSocketFactory",Address ());</span><br><span class="line">  onoff1.SetAttribute (<span class="string">"OnTime"</span>, StringValue (<span class="string">"ns3::ConstantRandomVariable[Constant=1.0]"</span>));</span><br><span class="line">  onoff1.SetAttribute (<span class="string">"OffTime"</span>, StringValue (<span class="string">"ns3::ConstantRandomVariable[Constant=0.0]"</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nSinks; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      Ptr&lt;Socket&gt; sink = SetupPacketReceive (adhocInterfaces.GetAddress (i), adhocNodes.Get (i));</span><br><span class="line"></span><br><span class="line">      AddressValue remoteAddress (InetSocketAddress (adhocInterfaces.GetAddress (i), port));</span><br><span class="line">      onoff1.SetAttribute (<span class="string">"Remote"</span>, remoteAddress);</span><br><span class="line"></span><br><span class="line">      Ptr&lt;UniformRandomVariable&gt; var = CreateObject&lt;UniformRandomVariable&gt; ();</span><br><span class="line">      ApplicationContainer temp = onoff1.Install (adhocNodes.Get (i + nSinks));</span><br><span class="line">      temp.Start (Seconds (var-&gt;GetValue (<span class="number">100.0</span>,<span class="number">101.0</span>)));</span><br><span class="line">      temp.Stop (Seconds (TotalTime));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">stringstream</span> ss;</span><br><span class="line">  ss &lt;&lt; nWifis;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> nodes = ss.str ();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">stringstream</span> ss2;</span><br><span class="line">  ss2 &lt;&lt; nodeSpeed;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> sNodeSpeed = ss2.str ();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">stringstream</span> ss3;</span><br><span class="line">  ss3 &lt;&lt; nodePause;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> sNodePause = ss3.str ();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">stringstream</span> ss4;</span><br><span class="line">  ss4 &lt;&lt; rate;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span> sRate = ss4.str ();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//NS_LOG_INFO ("Configure Tracing.");</span></span><br><span class="line">  <span class="comment">//tr_name = tr_name + "_" + m_protocolName +"_" + nodes + "nodes_" + sNodeSpeed + "speed_" + sNodePause + "pause_" + sRate + "rate";</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//AsciiTraceHelper ascii;</span></span><br><span class="line">  <span class="comment">//Ptr&lt;OutputStreamWrapper&gt; osw = ascii.CreateFileStream ( (tr_name + ".tr").c_str());</span></span><br><span class="line">  <span class="comment">//wifiPhy.EnableAsciiAll (osw);</span></span><br><span class="line">  AsciiTraceHelper ascii;</span><br><span class="line">  MobilityHelper::EnableAsciiAll (ascii.CreateFileStream (tr_name + <span class="string">".mob"</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Ptr&lt;FlowMonitor&gt; flowmon;</span></span><br><span class="line">  <span class="comment">//FlowMonitorHelper flowmonHelper;</span></span><br><span class="line">  <span class="comment">//flowmon = flowmonHelper.InstallAll ();</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  NS_LOG_INFO (<span class="string">"Run Simulation."</span>);</span><br><span class="line"></span><br><span class="line">  CheckThroughput ();</span><br><span class="line"></span><br><span class="line">  Simulator::Stop (Seconds (TotalTime));</span><br><span class="line">  Simulator::Run ();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//flowmon-&gt;SerializeToXmlFile ((tr_name + ".flowmon").c_str(), false, false);</span></span><br><span class="line"></span><br><span class="line">  Simulator::Destroy ();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>仿真结果如下：</p>
<p><img src="https://ww4.sinaimg.cn/large/006tNc79gy1fdntmd2lvkj31kw0zknda.jpg" alt></p>
<p>注意，如果需要使用netanim来导出xml文件的时候，一定要把asciihelper注释掉，否则有冲突，不能正常工作！！！！！！</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <div id="comment" style="padding:10px;" class="vcomment"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = 'true' === 'true';
    var verify = 'false' === 'true';
    new Valine({
        el: '.vcomment',
        notify: notify,
        verify: verify,
        appId: "SX0mPqziXOUMpj0mhlJny5mj-gzGzoHsz",
        appKey: "qPhCOLrlsY4No7EBuLnHiOLY",
        placeholder: "Just go go",
        pageSize:'10',
        avatar:'identicon',
        lang:'zh-cn',
        guest_info: guest_info
    });
</script>


                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/07/14/网络/2017-07-14-Ego networks/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/03/13/VANET/2017-3-13-Vanet仿真-ns3(5)/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Fengrui Liu's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        liufengrui18z@ict.ac.cn
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/08/">八月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/07/">七月 2019<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/06/">六月 2019<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/05/">五月 2019<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/10/">十月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/04/">四月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">八月 2016<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">五月 2016<span class="sidebar_archives-count">1</span></a>
            </li></ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Anomaly-detection/">Anomaly detection<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/Concept/">Concept<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/Data-mining/">Data mining<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/Database/">Database<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/Information-Retrieval/">Information Retrieval<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/Pattern-recognition/">Pattern recognition<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Pi/">Pi<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/categories/RL/">RL<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/Security/">Security<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/categories/算法/">算法<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/categories/网络/">网络<span class="sidebar_archives-count">13</span></a>
            </li></ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">73</span>
            </a>
        </li>
        
            <li class="divider"></li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;Fengrui Liu's Blog
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>









   





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    


    
        <script>lsloader.load("hanabi","/js/hanabi-browser-bundle.js?Pki5+pzkluqu53g+ouMWpA==", true)</script>
    


<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
        
        
        HanabiBrowser.start('pre code',false);
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 0000;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
